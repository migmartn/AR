<!DOCTYPE html>
<html>
  <head>
    <!-- Incluir A-Frame -->
    <script src="https://aframe.io/releases/1.0.0/aframe.min.js"></script>
    <!-- Incluir AR.js para A-Frame -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
      <!-- Definir el marcador -->
      <a-marker preset="hiro">
        <!-- Añadir un cubo con animación de rebote, cambio de color y sonido -->
        <a-box id="animated-box" position="0 0.5 0" material="color: red;" sound="src: #bounce-sound; autoplay: false;"></a-box>
      </a-marker>
      
      <!-- Cámara controlada por AR.js -->
      <a-entity camera></a-entity>
      
      <!-- Definir el sonido -->
      <audio id="bounce-sound" src="https://www.fesliyanstudios.com/play-mp3/4383"></audio>
    </a-scene>

    <script>
      AFRAME.registerComponent("bounce-and-color", {
        init: function () {
          let el = this.el;
          let colors = ["red", "blue", "green", "yellow", "purple", "orange"];
          let index = 0;
          let direction = 1;
          let positionY = 0.5;
          let sound = document.querySelector("#bounce-sound");

          function animate() {
            positionY += 0.02 * direction;
            if (positionY >= 1 || positionY <= 0.5) {
              direction *= -1;
              index = (index + 1) % colors.length;
              el.setAttribute("material", "color", colors[index]);
              sound.currentTime = 0; // Reinicia el sonido
              sound.play(); // Reproduce el sonido
            }
            el.setAttribute("position", `0 ${positionY} 0`);
            requestAnimationFrame(animate);
          }
          animate();
        },
      });

      document.querySelector("#animated-box").setAttribute("bounce-and-color", "");
    </script>
  </body>
</html>